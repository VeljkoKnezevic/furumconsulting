---
// Header - Fixed navigation with scroll effect and mobile menu
// Uses vanilla JS for scroll detection and mobile toggle
---

<header class="header" id="main-header">
  <div class="container">
    <div class="header-inner">
      <!-- Logo -->
      <a href="/" class="logo">
        <span>OTA Independence</span>
      </a>

      <!-- Desktop Navigation -->
      <nav class="desktop-nav">
        <a href="#how-it-works">How It Works</a>
        <a href="#faq">FAQ</a>
        <a href="#apply" class="btn btn-primary">Book a Call</a>
      </nav>

      <!-- Mobile Menu Button -->
      <button
        class="mobile-menu-btn"
        id="mobile-menu-btn"
        aria-label="Toggle menu"
        aria-expanded="false"
      >
        <svg class="icon-menu" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="4" x2="20" y1="12" y2="12"/>
          <line x1="4" x2="20" y1="6" y2="6"/>
          <line x1="4" x2="20" y1="18" y2="18"/>
        </svg>
        <svg class="icon-close" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 6 6 18"/>
          <path d="m6 6 12 12"/>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <nav class="mobile-nav" id="mobile-nav">
      <a href="#how-it-works">How It Works</a>
      <a href="#faq">FAQ</a>
      <a href="#apply" class="btn btn-primary btn-full">Book a Call</a>
    </nav>
  </div>
</header>

<script>
  const header = document.getElementById('main-header');
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileNav = document.getElementById('mobile-nav');

  // Scroll detection
  const handleScroll = () => {
    if (window.scrollY > 20) {
      header?.classList.add('scrolled');
    } else {
      header?.classList.remove('scrolled');
    }
  };

  window.addEventListener('scroll', handleScroll, { passive: true });
  handleScroll(); // Check initial state

  // Mobile menu toggle
  mobileMenuBtn?.addEventListener('click', () => {
    const isOpen = header?.classList.toggle('menu-open');
    mobileMenuBtn.setAttribute('aria-expanded', String(isOpen));
  });

  // Close mobile menu when clicking a link
  mobileNav?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      header?.classList.remove('menu-open');
      mobileMenuBtn?.setAttribute('aria-expanded', 'false');
    });
  });
</script>

<style>
  .header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 50;
    background: transparent;
    transition: background 0.2s, box-shadow 0.2s;
    animation: slide-down 0.15s ease-out;
  }

  @keyframes slide-down {
    from {
      transform: translateY(-100%);
    }
    to {
      transform: translateY(0);
    }
  }

  .header.scrolled {
    background: hsl(var(--card) / 0.95);
    backdrop-filter: blur(12px);
    box-shadow: 0 2px 8px hsl(var(--foreground) / 0.05);
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .header-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 4rem;
  }

  @media (min-width: 768px) {
    .header-inner {
      height: 5rem;
    }
  }

  /* Logo */
  .logo {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
  }

  .logo span {
    font-family: var(--font-serif, Georgia, serif);
    font-size: 1.125rem;
    font-weight: 700;
    color: hsl(var(--forest));
  }

  @media (min-width: 768px) {
    .logo span {
      font-size: 1.25rem;
    }
  }

  /* Desktop Navigation */
  .desktop-nav {
    display: none;
    align-items: center;
    gap: 2rem;
  }

  @media (min-width: 768px) {
    .desktop-nav {
      display: flex;
    }
  }

  .desktop-nav a:not(.btn) {
    font-size: 0.875rem;
    font-weight: 500;
    color: hsl(var(--muted-foreground));
    text-decoration: none;
    transition: color 0.2s;
  }

  .desktop-nav a:not(.btn):hover {
    color: hsl(var(--foreground));
  }

  /* Buttons */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    text-decoration: none;
    border-radius: 0.375rem;
    transition: all 0.2s;
  }

  .btn-primary {
    background: hsl(var(--forest));
    color: white;
  }

  .btn-primary:hover {
    background: hsl(var(--forest) / 0.9);
  }

  .btn-full {
    width: 100%;
  }

  /* Mobile Menu Button */
  .mobile-menu-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    background: transparent;
    border: none;
    color: hsl(var(--foreground));
    cursor: pointer;
  }

  @media (min-width: 768px) {
    .mobile-menu-btn {
      display: none;
    }
  }

  .mobile-menu-btn .icon-close {
    display: none;
  }

  .header.menu-open .mobile-menu-btn .icon-menu {
    display: none;
  }

  .header.menu-open .mobile-menu-btn .icon-close {
    display: block;
  }

  /* Mobile Navigation */
  .mobile-nav {
    display: none;
    flex-direction: column;
    gap: 1rem;
    padding: 1rem 0;
    border-top: 1px solid hsl(var(--border));
  }

  .header.menu-open .mobile-nav {
    display: flex;
  }

  @media (min-width: 768px) {
    .mobile-nav {
      display: none !important;
    }
  }

  .mobile-nav a:not(.btn) {
    font-size: 0.875rem;
    font-weight: 500;
    color: hsl(var(--muted-foreground));
    text-decoration: none;
    padding: 0.5rem 0;
    transition: color 0.2s;
  }

  .mobile-nav a:not(.btn):hover {
    color: hsl(var(--foreground));
  }
</style>
